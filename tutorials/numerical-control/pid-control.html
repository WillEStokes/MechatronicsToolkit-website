<!DOCTYPE html>
<html>
  <head>
    <title>PID Control</title>
    <link rel="stylesheet" type="text/css" href="../../styles.css">
    <link rel="stylesheet" href="../../themes/vscode-dark.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.57.0/codemirror.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.57.0/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.57.0/mode/python/python.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- <script src="../lib/MathJax-2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
  </head>
  <body onload="initResponsePlot()">
    <h1>PID Control</h1>
    <section id="introduction"></section>
      <h2>Introduction</h2>
      <div id="content-intro"></div>
        <script>
            fetch('./content/pid-control-intro.txt')
                .then(response => response.text())
                .then(data => {
                    document.getElementById("content-intro").innerHTML = data;
                })
                .catch(error => {
                    console.log(error);
                });
        </script>
    <section id="theory"></section>
      <h2>Theory</h2>
      <div id="content-theory"></div>
        <script>
            fetch('./content/pid-control-theory.txt')
                .then(response => response.text())
                .then(data => {
                    document.getElementById("content-theory").innerHTML = data;
                })
                .catch(error => {
                    console.log(error);
                });
        </script>
    <section id="implementation"></section>
      <h2>Implementation</h2>
      <p>In this section, we will discuss how to implement a PID controller in a real-world scenario, including the use of a feedforward component to create a PIDF controller and the use of lambda tuning to optimize the controller in slow response systems.</p>
      <p>To calculate the proportional, integral and derivative terms, the following equations are used:</p>
      <p>$$P = K_p \cdot e$$</p>
      <p>$$I = I + K_i \cdot e \cdot \Delta t$$</p>
      <p>$$D = K_d \cdot \frac{\Delta e}{\Delta t}$$</p>
      <p>Where \(P\), \(I\), \(D\) are the proportional, integral, and derivative terms respectively. \(K_p\), \(K_i\), \(K_d\) are the corresponding gain constants, \(e\) is the error, \(\Delta t\) is the change in time, and \(\Delta e\) is the change in error.</p>
      <form>
        <div class="pid-input-container">
            <label>Enter P value:</label>
            <input type="text" id="P-input" placeholder="10">
            <button type="button" onclick="incrementValue('P-input', 1)">+</button>
            <button type="button" onclick="decrementValue('P-input', 1)">-</button>
        </div>
        <div class="pid-input-container">
            <label>Enter I value:</label>
            <input type="text" id="I-input" placeholder="1">
            <button type="button" onclick="incrementValue('I-input', 0.1)">+</button>
            <button type="button" onclick="decrementValue('I-input', 0.1)">-</button>
        </div>
        <div class="pid-input-container">
            <label>Enter F value:</label>
            <input type="text" id="F-input" placeholder="0">
            <button type="button" onclick="incrementValue('F-input', 1)">+</button>
            <button type="button" onclick="decrementValue('F-input', 1)">-</button>
        </div>
        <br><br>
        <button type="button" onclick="plotResponse()">Plot Response</button>
        <br><br>
      </form>
        <div id="response-plot"></div>
    <section id="code"></section>
      <h3>Example Python code</h3>
      <!-- <pre> -->
        <!-- <code id="content-python"> -->
      <p><textarea id="content-python"></textarea></p>
      <p><textarea id="content-python-usage"></textarea></p>
        <!-- </code> -->
      <!-- </pre> -->
      <p><a href="../../tools/python-console.html">Practice your coding skills with our Python console</a></p>
    <section id="tuning"></section>
      <h2>Tuning</h2>
        <p>Lambda tuning is a method for determining the optimal values of the proportional, integral, and derivative gain parameters (\(K_p\), \(K_i\), \(K_d\)) in a PID controller.
          The method is based on measuring the system's step response and calculating the optimal values of \(K_p\), \(K_i\), and \(K_d\) based on the values of \(T_d\) and \(\tau\), which are calculated from the step response.
        <div class="tuning-image">
          <img src="../../images/metrics-image.png" alt="Diagram showing Td and tau calculated from controller output step change">
        </div>
        <p>To calculate the proportional term, we use the equation:</p>
        <p>$$P = K_c \times e(t)$$</p>
        <p>Where \(K_c\) is the controller gain, and \(e(t)\) is the error at time \(t\).
        The integral term is calculated using:</p>
        <p>$$I = \frac{K_c}{\tau} \times \int e(t) dt$$</p>
        <p>Where \(\tau\) is the controller time constant, and the integral is taken over the entire time period of the step response.
        The derivative term is calculated using:</p>
        <p>$$D = \frac{K_c \times \lambda}{T_d}$$</p>
        <p>Where \(\lambda\) is the controller damping factor, and \(T_d\) is the controller derivative time constant.
        By tuning the values of \(K_p\), \(K_i\), and \(K_d\) using the lambda tuning method, it is possible to achieve faster and more stable control of the system.</p>
        <form>
          <label>Enter \(\gamma\) value:</label>
          <input type="text" id="gamma-input" placeholder="1">
          <br>
          <label>Enter \(\tau\) value:</label>
          <input type="text" id="tau-input" placeholder="1500">
          <br>
          <label>Enter \(\Delta PV\) value:</label>
          <input type="text" id="dpv-input" placeholder="15">
          <br>
          <label>Enter \(\Delta DutyCycle\) value:</label>
          <input type="text" id="ddc-input" placeholder="20">
          <br>
          <label>Enter \(T_d\) value:</label>
          <input type="text" id="td-input" placeholder="120">
          <br><br>
          <button type="button" onclick="calculatePID()">Calculate PID</button>
          <br><br>
          <label>\(P\):</label>
          <input type="text" id="p-output" readonly>
          <br>
          <label>\(I\):</label>
          <input type="text" id="i-output" readonly>
      </form>
      <h2>Conclusion</h2>
      <div id="content-conclusion"></div>
        <script>
            fetch('./content/pid-control-conclusion.txt')
                .then(response => response.text())
                .then(data => {
                    document.getElementById("content-conclusion").innerHTML = data;
                })
                .catch(error => {
                    console.log(error);
                });
        </script>
        <script src="./pid-control.js"></script>
  </body>
</html>
<div class="footer">
  <a class='back-to-topics' href="../../topics/numerical-control.html" style="border: 1px solid blue; border-radius: 25px; padding: 10px 20px; text-decoration: none; color: blue;">Back to Topics</a>
</div>
